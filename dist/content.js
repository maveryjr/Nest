(()=>{console.log("Nest content script loaded");var e=null,n=null;function t(){var t=window.getSelection(),s=null==t?void 0:t.toString().trim();if(s&&s.length>10){var a=null==t?void 0:t.getRangeAt(0);if(a){var c=function(e){var n=e.commonAncestorContainer.textContent||"",t=e.startOffset,o=e.endOffset,i=Math.max(0,t-100),r=Math.min(n.length,o+100);return n.substring(i,r)}(a);e={text:s,context:c,position:o(a)},function(e){i();var t=e.getBoundingClientRect();(n=document.createElement("div")).id="nest-highlight-button",n.innerHTML='\n    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>\n    </svg>\n    Save highlight\n  ',n.style.cssText="\n    position: fixed;\n    top: ".concat(t.bottom+window.scrollY+10,"px;\n    left: ").concat(t.left+window.scrollX,"px;\n    background: #10b981;\n    color: white;\n    padding: 8px 12px;\n    border-radius: 6px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    z-index: 10000;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\n    font-size: 13px;\n    font-weight: 500;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    animation: fadeIn 0.2s ease-out;\n    border: none;\n    text-decoration: none;\n  ");var o=document.createElement("style");o.textContent="\n    @keyframes fadeIn {\n      from { opacity: 0; transform: translateY(-10px); }\n      to { opacity: 1; transform: translateY(0); }\n    }\n  ",document.head.appendChild(o),n.addEventListener("click",r),document.body.appendChild(n),setTimeout(function(){n&&i()},5e3)}(a)}}else i(),e=null}function o(e){return{startOffset:e.startOffset,endOffset:e.endOffset}}function i(){n&&n.parentNode&&(n.parentNode.removeChild(n),n=null)}function r(){e&&(i(),chrome.runtime.sendMessage({action:"saveHighlight",selectedText:e.text,context:e.context,position:e.position},function(e){e&&e.success?s():console.error("Failed to save highlight:",null==e?void 0:e.error)}),e=null)}function s(){var e=document.createElement("div");e.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #8b5cf6;\n    color: white;\n    padding: 12px 24px;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    z-index: 10000;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\n    font-size: 14px;\n    font-weight: 500;\n    animation: slideIn 0.3s ease-out;\n  ",e.innerHTML="✨ Highlight saved to Nest",a(e)}function a(e){var n=document.createElement("style");n.textContent="\n    @keyframes slideIn {\n      from {\n        transform: translateX(100%);\n        opacity: 0;\n      }\n      to {\n        transform: translateX(0);\n        opacity: 1;\n      }\n    }\n  ",document.head.appendChild(n),document.body.appendChild(e),setTimeout(function(){e.parentNode&&(e.style.animation="slideIn 0.3s ease-out reverse",setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},300))},3e3)}chrome.runtime.onMessage.addListener(function(e,n,t){if(console.log("Content Script: Message received:",e),"getPageContent"===e.action){var o=function(){var e=document.querySelectorAll("script, style, nav, header, footer, .ad, .advertisement"),n=document.cloneNode(!0);e.forEach(function(e){var t=n.querySelector(e.tagName.toLowerCase());t&&t.remove()});var t=n.querySelector("main")||n.querySelector("article")||n.querySelector(".content")||n.querySelector("#content")||n.querySelector(".post")||n.querySelector(".entry")||n.body;t||(t=n.body);var o=t.textContent||t.innerText||"";return(o=o.replace(/\s+/g," ").replace(/\n\s*\n/g,"\n").trim()).length>3e3&&(o=o.substring(0,3e3)+"..."),o}();console.log("Content Script: Sending page content, length:",o.length),t({content:o})}else"showSaveConfirmation"===e.action?((i=document.createElement("div")).style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #10b981;\n    color: white;\n    padding: 12px 24px;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    z-index: 10000;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\n    font-size: 14px;\n    font-weight: 500;\n    animation: slideIn 0.3s ease-out;\n  ",i.textContent="✓ Saved to Nest",a(i)):"showHighlightConfirmation"===e.action&&s();var i;return!0}),document.addEventListener("mouseup",t),document.addEventListener("keyup",t),document.addEventListener("click",function(e){n&&!n.contains(e.target)&&i()})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXN0LWNocm9tZS1leHRlbnNpb24vLi9zcmMvY29udGVudC9jb250ZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvbnRlbnQgc2NyaXB0IGZvciBleHRyYWN0aW5nIHBhZ2UgY29udGVudCBhbmQgaGFuZGxpbmcgaGlnaGxpZ2h0c1xuY29uc29sZS5sb2coJ05lc3QgY29udGVudCBzY3JpcHQgbG9hZGVkJyk7XG5cbi8vIEdsb2JhbCB2YXJpYWJsZXNcbmxldCBsYXN0U2VsZWN0aW9uOiB7IHRleHQ6IHN0cmluZzsgY29udGV4dDogc3RyaW5nOyBwb3NpdGlvbjogYW55IH0gfCBudWxsID0gbnVsbDtcbmxldCBoaWdobGlnaHRCdXR0b246IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cbi8vIExpc3RlbiBmb3IgbWVzc2FnZXMgZnJvbSBiYWNrZ3JvdW5kIHNjcmlwdFxuY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlLmFkZExpc3RlbmVyKChyZXF1ZXN0LCBzZW5kZXIsIHNlbmRSZXNwb25zZSkgPT4ge1xuICBjb25zb2xlLmxvZygnQ29udGVudCBTY3JpcHQ6IE1lc3NhZ2UgcmVjZWl2ZWQ6JywgcmVxdWVzdCk7XG4gIGlmIChyZXF1ZXN0LmFjdGlvbiA9PT0gJ2dldFBhZ2VDb250ZW50Jykge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBleHRyYWN0UGFnZUNvbnRlbnQoKTtcbiAgICBjb25zb2xlLmxvZygnQ29udGVudCBTY3JpcHQ6IFNlbmRpbmcgcGFnZSBjb250ZW50LCBsZW5ndGg6JywgY29udGVudC5sZW5ndGgpO1xuICAgIHNlbmRSZXNwb25zZSh7IGNvbnRlbnQgfSk7XG4gIH0gZWxzZSBpZiAocmVxdWVzdC5hY3Rpb24gPT09ICdzaG93U2F2ZUNvbmZpcm1hdGlvbicpIHtcbiAgICBzaG93U2F2ZUNvbmZpcm1hdGlvbigpO1xuICB9IGVsc2UgaWYgKHJlcXVlc3QuYWN0aW9uID09PSAnc2hvd0hpZ2hsaWdodENvbmZpcm1hdGlvbicpIHtcbiAgICBzaG93SGlnaGxpZ2h0Q29uZmlybWF0aW9uKCk7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59KTtcblxuLy8gSGFuZGxlIHRleHQgc2VsZWN0aW9uIGZvciBoaWdobGlnaHRzXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgaGFuZGxlVGV4dFNlbGVjdGlvbik7XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGhhbmRsZVRleHRTZWxlY3Rpb24pO1xuXG5mdW5jdGlvbiBoYW5kbGVUZXh0U2VsZWN0aW9uKCkge1xuICBjb25zdCBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XG4gIGNvbnN0IHNlbGVjdGVkVGV4dCA9IHNlbGVjdGlvbj8udG9TdHJpbmcoKS50cmltKCk7XG4gIFxuICBpZiAoc2VsZWN0ZWRUZXh0ICYmIHNlbGVjdGVkVGV4dC5sZW5ndGggPiAxMCkgeyAvLyBNaW5pbXVtIGxlbmd0aCBmb3IgbWVhbmluZ2Z1bCBoaWdobGlnaHRzXG4gICAgY29uc3QgcmFuZ2UgPSBzZWxlY3Rpb24/LmdldFJhbmdlQXQoMCk7XG4gICAgaWYgKHJhbmdlKSB7XG4gICAgICAvLyBHZXQgY29udGV4dCBhcm91bmQgdGhlIHNlbGVjdGlvblxuICAgICAgY29uc3QgY29udGV4dCA9IGdldFNlbGVjdGlvbkNvbnRleHQocmFuZ2UpO1xuICAgICAgXG4gICAgICAvLyBTdG9yZSBzZWxlY3Rpb24gZGF0YVxuICAgICAgbGFzdFNlbGVjdGlvbiA9IHtcbiAgICAgICAgdGV4dDogc2VsZWN0ZWRUZXh0LFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBwb3NpdGlvbjogZ2V0U2VsZWN0aW9uUG9zaXRpb24ocmFuZ2UpXG4gICAgICB9O1xuICAgICAgXG4gICAgICBzaG93SGlnaGxpZ2h0QnV0dG9uKHJhbmdlKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaGlkZUhpZ2hsaWdodEJ1dHRvbigpO1xuICAgIGxhc3RTZWxlY3Rpb24gPSBudWxsO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldFNlbGVjdGlvbkNvbnRleHQocmFuZ2U6IFJhbmdlKTogc3RyaW5nIHtcbiAgY29uc3QgY29udGFpbmVyID0gcmFuZ2UuY29tbW9uQW5jZXN0b3JDb250YWluZXI7XG4gIGNvbnN0IHRleHRDb250ZW50ID0gY29udGFpbmVyLnRleHRDb250ZW50IHx8ICcnO1xuICBjb25zdCBzdGFydE9mZnNldCA9IHJhbmdlLnN0YXJ0T2Zmc2V0O1xuICBjb25zdCBlbmRPZmZzZXQgPSByYW5nZS5lbmRPZmZzZXQ7XG4gIFxuICAvLyBHZXQgc3Vycm91bmRpbmcgY29udGV4dCAodXAgdG8gMTAwIGNoYXJhY3RlcnMgYmVmb3JlIGFuZCBhZnRlcilcbiAgY29uc3QgY29udGV4dFN0YXJ0ID0gTWF0aC5tYXgoMCwgc3RhcnRPZmZzZXQgLSAxMDApO1xuICBjb25zdCBjb250ZXh0RW5kID0gTWF0aC5taW4odGV4dENvbnRlbnQubGVuZ3RoLCBlbmRPZmZzZXQgKyAxMDApO1xuICBcbiAgcmV0dXJuIHRleHRDb250ZW50LnN1YnN0cmluZyhjb250ZXh0U3RhcnQsIGNvbnRleHRFbmQpO1xufVxuXG5mdW5jdGlvbiBnZXRTZWxlY3Rpb25Qb3NpdGlvbihyYW5nZTogUmFuZ2UpOiBhbnkge1xuICAvLyBTaW1wbGUgcG9zaXRpb24gdHJhY2tpbmcgLSBjb3VsZCBiZSBlbmhhbmNlZCB3aXRoIFhQYXRoIGZvciBtb3JlIHByZWNpc2lvblxuICByZXR1cm4ge1xuICAgIHN0YXJ0T2Zmc2V0OiByYW5nZS5zdGFydE9mZnNldCxcbiAgICBlbmRPZmZzZXQ6IHJhbmdlLmVuZE9mZnNldCxcbiAgICAvLyBDb3VsZCBhZGQgWFBhdGggaGVyZSBmb3IgbW9yZSByb2J1c3QgcG9zaXRpb25pbmdcbiAgfTtcbn1cblxuZnVuY3Rpb24gc2hvd0hpZ2hsaWdodEJ1dHRvbihyYW5nZTogUmFuZ2UpIHtcbiAgaGlkZUhpZ2hsaWdodEJ1dHRvbigpOyAvLyBSZW1vdmUgYW55IGV4aXN0aW5nIGJ1dHRvblxuICBcbiAgY29uc3QgcmVjdCA9IHJhbmdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICBcbiAgaGlnaGxpZ2h0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGhpZ2hsaWdodEJ1dHRvbi5pZCA9ICduZXN0LWhpZ2hsaWdodC1idXR0b24nO1xuICBoaWdobGlnaHRCdXR0b24uaW5uZXJIVE1MID0gYFxuICAgIDxzdmcgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICAgICAgPHBhdGggZD1cIk0xMiAyTDEzLjA5IDguMjZMMjAgOUwxMy4wOSA5Ljc0TDEyIDE2TDEwLjkxIDkuNzRMNCA5TDEwLjkxIDguMjZMMTIgMlpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG4gICAgPC9zdmc+XG4gICAgU2F2ZSBoaWdobGlnaHRcbiAgYDtcbiAgXG4gIGhpZ2hsaWdodEJ1dHRvbi5zdHlsZS5jc3NUZXh0ID0gYFxuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6ICR7cmVjdC5ib3R0b20gKyB3aW5kb3cuc2Nyb2xsWSArIDEwfXB4O1xuICAgIGxlZnQ6ICR7cmVjdC5sZWZ0ICsgd2luZG93LnNjcm9sbFh9cHg7XG4gICAgYmFja2dyb3VuZDogIzEwYjk4MTtcbiAgICBjb2xvcjogd2hpdGU7XG4gICAgcGFkZGluZzogOHB4IDEycHg7XG4gICAgYm9yZGVyLXJhZGl1czogNnB4O1xuICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcbiAgICB6LWluZGV4OiAxMDAwMDtcbiAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBzeXN0ZW0tdWksIHNhbnMtc2VyaWY7XG4gICAgZm9udC1zaXplOiAxM3B4O1xuICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBnYXA6IDZweDtcbiAgICBhbmltYXRpb246IGZhZGVJbiAwLjJzIGVhc2Utb3V0O1xuICAgIGJvcmRlcjogbm9uZTtcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG4gIGA7XG4gIFxuICAvLyBBZGQgYW5pbWF0aW9uIGtleWZyYW1lc1xuICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gIHN0eWxlLnRleHRDb250ZW50ID0gYFxuICAgIEBrZXlmcmFtZXMgZmFkZUluIHtcbiAgICAgIGZyb20geyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwcHgpOyB9XG4gICAgICB0byB7IG9wYWNpdHk6IDE7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgfVxuICAgIH1cbiAgYDtcbiAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gIFxuICBoaWdobGlnaHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzYXZlSGlnaGxpZ2h0KTtcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChoaWdobGlnaHRCdXR0b24pO1xuICBcbiAgLy8gQXV0by1oaWRlIGFmdGVyIDUgc2Vjb25kcyBvciB3aGVuIHVzZXIgY2xpY2tzIGVsc2V3aGVyZVxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBpZiAoaGlnaGxpZ2h0QnV0dG9uKSB7XG4gICAgICBoaWRlSGlnaGxpZ2h0QnV0dG9uKCk7XG4gICAgfVxuICB9LCA1MDAwKTtcbn1cblxuZnVuY3Rpb24gaGlkZUhpZ2hsaWdodEJ1dHRvbigpIHtcbiAgaWYgKGhpZ2hsaWdodEJ1dHRvbiAmJiBoaWdobGlnaHRCdXR0b24ucGFyZW50Tm9kZSkge1xuICAgIGhpZ2hsaWdodEJ1dHRvbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGhpZ2hsaWdodEJ1dHRvbik7XG4gICAgaGlnaGxpZ2h0QnV0dG9uID0gbnVsbDtcbiAgfVxufVxuXG5mdW5jdGlvbiBzYXZlSGlnaGxpZ2h0KCkge1xuICBpZiAoIWxhc3RTZWxlY3Rpb24pIHJldHVybjtcbiAgXG4gIGhpZGVIaWdobGlnaHRCdXR0b24oKTtcbiAgXG4gIC8vIFNlbmQgbWVzc2FnZSB0byBiYWNrZ3JvdW5kIHNjcmlwdCB0byBzYXZlIGhpZ2hsaWdodFxuICBjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZSh7XG4gICAgYWN0aW9uOiAnc2F2ZUhpZ2hsaWdodCcsXG4gICAgc2VsZWN0ZWRUZXh0OiBsYXN0U2VsZWN0aW9uLnRleHQsXG4gICAgY29udGV4dDogbGFzdFNlbGVjdGlvbi5jb250ZXh0LFxuICAgIHBvc2l0aW9uOiBsYXN0U2VsZWN0aW9uLnBvc2l0aW9uXG4gIH0sIChyZXNwb25zZSkgPT4ge1xuICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICBzaG93SGlnaGxpZ2h0Q29uZmlybWF0aW9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGhpZ2hsaWdodDonLCByZXNwb25zZT8uZXJyb3IpO1xuICAgIH1cbiAgfSk7XG4gIFxuICBsYXN0U2VsZWN0aW9uID0gbnVsbDtcbn1cblxuLy8gSGlkZSBoaWdobGlnaHQgYnV0dG9uIHdoZW4gdXNlciBjbGlja3MgZWxzZXdoZXJlXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICBpZiAoaGlnaGxpZ2h0QnV0dG9uICYmICFoaWdobGlnaHRCdXR0b24uY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XG4gICAgaGlkZUhpZ2hsaWdodEJ1dHRvbigpO1xuICB9XG59KTtcblxuZnVuY3Rpb24gZXh0cmFjdFBhZ2VDb250ZW50KCk6IHN0cmluZyB7XG4gIC8vIFJlbW92ZSBzY3JpcHQgYW5kIHN0eWxlIGVsZW1lbnRzXG4gIGNvbnN0IGVsZW1lbnRzVG9SZW1vdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHQsIHN0eWxlLCBuYXYsIGhlYWRlciwgZm9vdGVyLCAuYWQsIC5hZHZlcnRpc2VtZW50Jyk7XG4gIGNvbnN0IGNsb25lZERvYyA9IGRvY3VtZW50LmNsb25lTm9kZSh0cnVlKSBhcyBEb2N1bWVudDtcbiAgXG4gIGVsZW1lbnRzVG9SZW1vdmUuZm9yRWFjaChlbCA9PiB7XG4gICAgY29uc3QgY2xvbmVkRWwgPSBjbG9uZWREb2MucXVlcnlTZWxlY3RvcihlbC50YWdOYW1lLnRvTG93ZXJDYXNlKCkpO1xuICAgIGlmIChjbG9uZWRFbCkge1xuICAgICAgY2xvbmVkRWwucmVtb3ZlKCk7XG4gICAgfVxuICB9KTtcblxuICAvLyBUcnkgdG8gZmluZCBtYWluIGNvbnRlbnQgYXJlYVxuICBsZXQgY29udGVudEVsZW1lbnQgPSBcbiAgICBjbG9uZWREb2MucXVlcnlTZWxlY3RvcignbWFpbicpIHx8XG4gICAgY2xvbmVkRG9jLnF1ZXJ5U2VsZWN0b3IoJ2FydGljbGUnKSB8fFxuICAgIGNsb25lZERvYy5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpIHx8XG4gICAgY2xvbmVkRG9jLnF1ZXJ5U2VsZWN0b3IoJyNjb250ZW50JykgfHxcbiAgICBjbG9uZWREb2MucXVlcnlTZWxlY3RvcignLnBvc3QnKSB8fFxuICAgIGNsb25lZERvYy5xdWVyeVNlbGVjdG9yKCcuZW50cnknKSB8fFxuICAgIGNsb25lZERvYy5ib2R5O1xuXG4gIGlmICghY29udGVudEVsZW1lbnQpIHtcbiAgICBjb250ZW50RWxlbWVudCA9IGNsb25lZERvYy5ib2R5O1xuICB9XG5cbiAgLy8gRXh0cmFjdCB0ZXh0IGNvbnRlbnRcbiAgbGV0IHRleHQgPSBjb250ZW50RWxlbWVudC50ZXh0Q29udGVudCB8fCBjb250ZW50RWxlbWVudC5pbm5lclRleHQgfHwgJyc7XG4gIFxuICAvLyBDbGVhbiB1cCB0aGUgdGV4dFxuICB0ZXh0ID0gdGV4dFxuICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgLy8gUmVwbGFjZSBtdWx0aXBsZSB3aGl0ZXNwYWNlIHdpdGggc2luZ2xlIHNwYWNlXG4gICAgLnJlcGxhY2UoL1xcblxccypcXG4vZywgJ1xcbicpIC8vIFJlbW92ZSBlbXB0eSBsaW5lc1xuICAgIC50cmltKCk7XG5cbiAgLy8gTGltaXQgbGVuZ3RoIHRvIGF2b2lkIGV4Y2Vzc2l2ZSBjb250ZW50XG4gIGNvbnN0IG1heExlbmd0aCA9IDMwMDA7XG4gIGlmICh0ZXh0Lmxlbmd0aCA+IG1heExlbmd0aCkge1xuICAgIHRleHQgPSB0ZXh0LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLic7XG4gIH1cblxuICByZXR1cm4gdGV4dDtcbn1cblxuLy8gQWRkIHZpc3VhbCBmZWVkYmFjayB3aGVuIHBhZ2UgaXMgc2F2ZWRcbmZ1bmN0aW9uIHNob3dTYXZlQ29uZmlybWF0aW9uKCkge1xuICBjb25zdCBub3RpZmljYXRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgbm90aWZpY2F0aW9uLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIHRvcDogMjBweDtcbiAgICByaWdodDogMjBweDtcbiAgICBiYWNrZ3JvdW5kOiAjMTBiOTgxO1xuICAgIGNvbG9yOiB3aGl0ZTtcbiAgICBwYWRkaW5nOiAxMnB4IDI0cHg7XG4gICAgYm9yZGVyLXJhZGl1czogOHB4O1xuICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcbiAgICB6LWluZGV4OiAxMDAwMDtcbiAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBzeXN0ZW0tdWksIHNhbnMtc2VyaWY7XG4gICAgZm9udC1zaXplOiAxNHB4O1xuICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgYW5pbWF0aW9uOiBzbGlkZUluIDAuM3MgZWFzZS1vdXQ7XG4gIGA7XG4gIFxuICBub3RpZmljYXRpb24udGV4dENvbnRlbnQgPSAn4pyTIFNhdmVkIHRvIE5lc3QnO1xuICBcbiAgc2hvd05vdGlmaWNhdGlvbihub3RpZmljYXRpb24pO1xufVxuXG4vLyBBZGQgdmlzdWFsIGZlZWRiYWNrIHdoZW4gaGlnaGxpZ2h0IGlzIHNhdmVkXG5mdW5jdGlvbiBzaG93SGlnaGxpZ2h0Q29uZmlybWF0aW9uKCkge1xuICBjb25zdCBub3RpZmljYXRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgbm90aWZpY2F0aW9uLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIHRvcDogMjBweDtcbiAgICByaWdodDogMjBweDtcbiAgICBiYWNrZ3JvdW5kOiAjOGI1Y2Y2O1xuICAgIGNvbG9yOiB3aGl0ZTtcbiAgICBwYWRkaW5nOiAxMnB4IDI0cHg7XG4gICAgYm9yZGVyLXJhZGl1czogOHB4O1xuICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcbiAgICB6LWluZGV4OiAxMDAwMDtcbiAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBzeXN0ZW0tdWksIHNhbnMtc2VyaWY7XG4gICAgZm9udC1zaXplOiAxNHB4O1xuICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgYW5pbWF0aW9uOiBzbGlkZUluIDAuM3MgZWFzZS1vdXQ7XG4gIGA7XG4gIFxuICBub3RpZmljYXRpb24uaW5uZXJIVE1MID0gJ+KcqCBIaWdobGlnaHQgc2F2ZWQgdG8gTmVzdCc7XG4gIFxuICBzaG93Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbik7XG59XG5cbmZ1bmN0aW9uIHNob3dOb3RpZmljYXRpb24obm90aWZpY2F0aW9uOiBIVE1MRWxlbWVudCkge1xuICAvLyBBZGQgYW5pbWF0aW9uIGtleWZyYW1lc1xuICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gIHN0eWxlLnRleHRDb250ZW50ID0gYFxuICAgIEBrZXlmcmFtZXMgc2xpZGVJbiB7XG4gICAgICBmcm9tIHtcbiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDEwMCUpO1xuICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgfVxuICAgICAgdG8ge1xuICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7XG4gICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICB9XG4gICAgfVxuICBgO1xuICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgXG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobm90aWZpY2F0aW9uKTtcbiAgXG4gIC8vIFJlbW92ZSBhZnRlciAzIHNlY29uZHNcbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgaWYgKG5vdGlmaWNhdGlvbi5wYXJlbnROb2RlKSB7XG4gICAgICBub3RpZmljYXRpb24uc3R5bGUuYW5pbWF0aW9uID0gJ3NsaWRlSW4gMC4zcyBlYXNlLW91dCByZXZlcnNlJztcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAobm90aWZpY2F0aW9uLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICBub3RpZmljYXRpb24ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub3RpZmljYXRpb24pO1xuICAgICAgICB9XG4gICAgICB9LCAzMDApO1xuICAgIH1cbiAgfSwgMzAwMCk7XG59ICJdLCJuYW1lcyI6WyJjb25zb2xlIiwibG9nIiwibGFzdFNlbGVjdGlvbiIsImhpZ2hsaWdodEJ1dHRvbiIsImhhbmRsZVRleHRTZWxlY3Rpb24iLCJzZWxlY3Rpb24iLCJ3aW5kb3ciLCJnZXRTZWxlY3Rpb24iLCJzZWxlY3RlZFRleHQiLCJ0b1N0cmluZyIsInRyaW0iLCJsZW5ndGgiLCJyYW5nZSIsImdldFJhbmdlQXQiLCJjb250ZXh0IiwidGV4dENvbnRlbnQiLCJjb21tb25BbmNlc3RvckNvbnRhaW5lciIsInN0YXJ0T2Zmc2V0IiwiZW5kT2Zmc2V0IiwiY29udGV4dFN0YXJ0IiwiTWF0aCIsIm1heCIsImNvbnRleHRFbmQiLCJtaW4iLCJzdWJzdHJpbmciLCJnZXRTZWxlY3Rpb25Db250ZXh0IiwidGV4dCIsInBvc2l0aW9uIiwiZ2V0U2VsZWN0aW9uUG9zaXRpb24iLCJoaWRlSGlnaGxpZ2h0QnV0dG9uIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiaW5uZXJIVE1MIiwic3R5bGUiLCJjc3NUZXh0IiwiY29uY2F0IiwiYm90dG9tIiwic2Nyb2xsWSIsImxlZnQiLCJzY3JvbGxYIiwiaGVhZCIsImFwcGVuZENoaWxkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNhdmVIaWdobGlnaHQiLCJib2R5Iiwic2V0VGltZW91dCIsInNob3dIaWdobGlnaHRCdXR0b24iLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJjaHJvbWUiLCJydW50aW1lIiwic2VuZE1lc3NhZ2UiLCJhY3Rpb24iLCJyZXNwb25zZSIsInN1Y2Nlc3MiLCJzaG93SGlnaGxpZ2h0Q29uZmlybWF0aW9uIiwiZXJyb3IiLCJub3RpZmljYXRpb24iLCJzaG93Tm90aWZpY2F0aW9uIiwiYW5pbWF0aW9uIiwib25NZXNzYWdlIiwiYWRkTGlzdGVuZXIiLCJyZXF1ZXN0Iiwic2VuZGVyIiwic2VuZFJlc3BvbnNlIiwiY29udGVudCIsImVsZW1lbnRzVG9SZW1vdmUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2xvbmVkRG9jIiwiY2xvbmVOb2RlIiwiZm9yRWFjaCIsImVsIiwiY2xvbmVkRWwiLCJxdWVyeVNlbGVjdG9yIiwidGFnTmFtZSIsInRvTG93ZXJDYXNlIiwicmVtb3ZlIiwiY29udGVudEVsZW1lbnQiLCJpbm5lclRleHQiLCJyZXBsYWNlIiwiZXh0cmFjdFBhZ2VDb250ZW50IiwiZXZlbnQiLCJjb250YWlucyIsInRhcmdldCJdLCJzb3VyY2VSb290IjoiIn0=